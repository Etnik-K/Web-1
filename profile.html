<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile</title>
    <link rel="stylesheet" href="profile.css">
    <link rel="shortcut icon" type="image" href="logo.png">
    <style>
        .tasks-container {
        display: flex;
        justify-content: center;
        align-items: center;
        align-content: center;
        flex-wrap: wrap; /* Lejo rreshtimin nëse nuk ka mjaftueshëm hapësirë në një rresht */
        }
        .task-text{
            justify-content: center;
            align-items: center;
        }
        .task {
            border: 1px solid #ccc;
            padding: 10px;
            margin: auto;
            margin-top: 20px;
            margin-bottom: 20px;
            cursor: grab;
            flex: 0 0 calc(33.33% - 20px); /* Përdor calc() për të ndarë hapësirën në 3 kolona me një margin prej 10px */
            text-align: center; /* Vendos tekstin në qendër të taskut */
        }

        .task:hover {
            background-color: #f0f0f0;
        }

        .task.dragover {
            border: 2px dashed #333;
        }
       
        .suggestion {
            font-size: 14px; /* Zgjidhni madhësinë e dëshiruar */
        }

        .search-container {
            position: relative;
        }

        .material-icons {
            position: absolute;
            right: 10px; /* Zgjidhni distancën nga e drejta e dëshiruar */
            top: 50%;
            transform: translateY(-50%);
        }
    </style>

    
</head>

<body id="body">
    <nav id="phone-nav">
        <div class="navbar">
          <div class="container nav-container">
              <input class="checkbox" type="checkbox" name="" id="" />
                </s> <div class="hamburger-lines">
                <span class="line line1"></span>
                <span class="line line2"></span>
                <span class="line line3"></span>
              </div>  
            <div class="logo">
              <a href="home.html"><img src="logo.png" alt=""></a>
            </div>
            <div class="menu-items">
              <li><a href="login.html">Log out</a></li>
              <li><a href="about.html">About</a></li>
              <li><a target="_blank" href="search.html">Search</a></li>

            
            </div>
          </div>
        </div>
      </nav>
    <header>
   <a href="home.html" id="logo"><img src="logo.png" alt=""></a>
    <nav>
        <ul class="nav_links">
             <li><div class="boxContainer">
                <table class="elementsContainer">
                 <tr>
                     <td>
                         <input type="text" name="" class="search" placeholder="Search course...">
                     </td>
                     <td>
                        <a href="#" style="position: absolute; top: 10%; transform: translateY(-50%);">
                            <img src="loupe 1.png" alt="" class="material-icons"></a>
                     </td>
                 </tr>
                </table>
            </div></li>
            <li><a class="nav-link" href="login.html">Log out</a></li>
            <li><a href="about.html" target="_blank"  class="nav-link">About</a></li>
    
        </ul>
    </nav>
    </header>

    <div id="name-xp">
     <div id="pfp-info">
    <img src="Profile Picture.png" alt="" id="pfp-img" class="info-img">
    <p>Username</p> 
</div>
<div id="badge-xp">
<img src="badge.png" alt="" id="badge-img" class="info-img">
<p id="xp">0</p><p>xp</p>
</div>
    </div>

    
<div id="tasks">
    <div id="schedule-text-image">
        <p>Add a new Task </p>
        <button id="addButton" style="background-color: transparent; border: none;"><img src="add.png" ></img></button>
    </div>
    </div>
    </div>
    <div class="task" id="task1">
        <div id="textbox1">
            <p id="task-text1">Task 1</p>
        </div>
        <div class="task-images" >
        <button style="background-color: transparent; border: none;" onclick="transformToTextboxTask1(task-text1)"><img src="edit.png" class="edit-img" alt="" title="Edit Task Name" id="edit"> </button>  </div>
        <button style="background-color: transparent; border: none;" onclick="deleteTask('task1')"><img src="clipboard.png" alt="" title="Remove Task" id="completed"></button>   
    </div>
    <div class="task" id="task2">
        <p class="task-text2">Task 2</p>
        <div class="task-images">
            <button style="background-color: transparent; border: none;" onclick="transformToTextboxTask1(task-text2)"><img src="edit.png" class="edit-img" alt="" title="Edit Task Name"> </button>  </div>
            <button style="background-color: transparent; border: none;" onclick="deleteTask('task2')"><img src="clipboard.png" alt="" title="Remove Task" id="completed"></button> 
    </div>
    <div class="task" id="task3">
        <p class="task-text3">Task 3</p>
        <div class="task-images">
        <button style="background-color: transparent; border: none;" onclick="transformToTextboxTask1(task-text3)"><img src="edit.png" class="edit-img" alt="" title="Edit Task Name"> </button>  </div>
        <button style="background-color: transparent; border: none;" onclick="deleteTask('task3')"><img src="clipboard.png" alt="" title="Remove Task" id="completed"></button>
    </div>      
</div>


</div> 
</div>
<div id="buttons">
<a href="personal-library.html"><button class="button">
    <img class="button-image button-1" src="personal-library-icon.png" alt="">
<p class="button-txt">Personal Library</p>
</button></a>
<a href="challenges.html"><button class="button">
    <img class="button-image" src="challenges-icon.png" alt="">
<a href="challenges.html"><p class="button-txt">Challenges</p>
</button></a></div>
<a href="settings.html"><button class="button">
    <img class="button-image" src="settings-icon.png" alt="">
<p class="button-txt">Settings</p>
</button></a>
<a href="leaderboard.html"><button class="button">
    <img class="button-image" src="leaderboard.png" alt="">
<p class="button-txt">Leaderboard</p>
</button></a>
</div>
<div id="popup2" class="overlay">
	<div class="popup">
		<h2 id="edit-task-title">New Task</h2>
		<a class="close" href="#">&times;</a>
		<div class="content">
            <div id="edit-task">
                <form id="form-edit-task" action="">
                    <input type="text" name="" id="task-name" class="edit-input" placeholder="Task Name">
                    <input type="text" name="alert-time" id="alert-time" class="edit-input" placeholder="Alert Time">
                    <input type="datetime" name="" id="dead-line" class="edit-input" placeholder="Deadline">    
                </form>
                <button id="confirm">Save</button>
		</div>
        </div>
        </div>
        </div>
<div id="popup1" class="overlay">
	<div class="popup">
		<h2 id="edit-task-title">Edit Task</h2>
		<a class="close" href="#">&times;</a>
		<div class="content">
            <div id="edit-task">
                <form id="form-edit-task" action="">
                    <input type="text" name="" id="task-name" class="edit-input" placeholder="Task Name">
                    <input type="text" name="alert-time" id="alert-time" class="edit-input" placeholder="Alert Time">
                    <input type="datetime" name="" id="dead-line" class="edit-input" placeholder="Deadline">    
                </form>
                <button id="confirm">Save</button>
		    </div>
	    </div>
    </div>
</div>
<footer id="footer">
    <div id="footer-container">
        <div id="books">
            <h1 id="books-title">Books</h1>
            <a href=""><p class="books-paragraph">Elon Musk</p></a>
            <a href=""><p class="books-paragraph">Java</p></a>
            <a href=""><p class="books-paragraph">Artificial Intelligence</p></a>
        </div>
        <div id="explore">
            <h1 id="explore-title">Explore</h1>
            <a href="about.html"><p class="explore-paragraph">About</p></a>
            <a href=""><p class="explore-paragraph">Overview</p></a>
            <a href="sign-up.html"><p class="explore-paragraph">Join Us</p></a>
        </div>
        <div id="gallery">
            <h1 id="gallery-title">Gallery</h1>
            <div id="first-pair">
            <img src="footer-image-1.png" alt="" class="gallery-img">
            <img src="footer-image-2.png" alt="" class="gallery-img">
            </div>
            <div id="second-pair">
            <img src="footer-image-3.png" alt="" class="gallery-img">
            <img src="footer-image-4.png" alt="" class="gallery-img">
            </div>
        </div>
        <div id="about">
            <h1 id="about-title">About</h1>
            <p class="about-paragraph">An educational platform that <br>
                encourages learning through <br>
                 interactivity and fun. </p>
                  <div id="footer-buttons">
               <a href="contact.html"><button class="footer-button" id="contact-button">Contact</button></a>
                <button class="footer-button" id="help-button">Help</button>
                  </div>       
        </div>
    </div>
    </footer>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            loadTasksFromLocalStorage();
    // Load tasks from local storage
    loadTasksFromLocalStorage();
    

    const tasks = document.querySelectorAll('.task');

    tasks.forEach(task => {
        task.setAttribute('draggable', true);

        task.addEventListener('dragstart', handleDragStart);
        task.addEventListener('dragenter', handleDragEnter);
        task.addEventListener('dragover', handleDragOver);
        task.addEventListener('dragleave', handleDragLeave);
        task.addEventListener('drop', handleDrop);
        task.addEventListener('dragend', handleDragEnd);
    });

    let dragSrcElement = null;

    function handleDragStart(e) {
        this.style.opacity = '0.4';
        dragSrcElement = this;

        e.dataTransfer.effectAllowed = 'move';
        e.dataTransfer.setData('text/html', this.innerHTML);
    }

    function handleDragEnter(e) {
        this.classList.add('dragover');
    }

    function handleDragOver(e) {
        if (e.preventDefault) {
            e.preventDefault();
        }

        e.dataTransfer.dropEffect = 'move';
        return false;
    }

    function handleDragLeave() {
        this.classList.remove('dragover');
    }

    function handleDrop(e) {
        if (e.stopPropagation) {
            e.stopPropagation();
        }

        if (dragSrcElement !== this) {
            dragSrcElement.innerHTML = this.innerHTML;
            this.innerHTML = e.dataTransfer.getData('text/html');
        }

        return false;
    }

    function handleDragEnd() {
        this.style.opacity = '1';
        tasks.forEach(task => task.classList.remove('dragover'));

        // Save tasks to local storage after dragging
        saveTasksToLocalStorage();
    }
});

document.getElementById('addButton').addEventListener('click', function () {
    // Prompt the user for a new task name
    const taskName = prompt('Enter the new task name:');
    if (taskName !== null && taskName.trim() !== '') {
        // Create a new task with the same structure as existing tasks
        const newTask = document.createElement('div');
        newTask.classList.add('task');

        // Generate a unique ID for the new task
        const existingTasks = document.querySelectorAll('.task');
        const newTaskId = 'task' + (existingTasks.length + 1);
        newTask.id = newTaskId;

        // Create the div with ID "textbox" inside the new task
        const textboxDiv = document.createElement('div');
        textboxDiv.id = 'textbox' + newTaskId.charAt(newTaskId.length - 1);

        // Create the paragraph element inside the textboxDiv
        const taskText = document.createElement('p');
        taskText.id = 'task-text' + newTaskId.charAt(newTaskId.length - 1);
        taskText.textContent = taskName;

        // Append the taskText to the textboxDiv
        textboxDiv.appendChild(taskText);

        // Append the textboxDiv to the newTask
        newTask.appendChild(textboxDiv);

        // Create the task-images container inside the new task
        const taskImagesContainer = document.createElement('div');
        taskImagesContainer.classList.add('task-images');

        // Create the edit button with onclick attribute
        const editButton = document.createElement('button');
        editButton.style = "background-color: transparent; border: none;";
        editButton.setAttribute('onclick', `transformToTextboxTask1('${textboxDiv.id}')`);
        editButton.innerHTML = '<img src="edit.png" class="edit-img" alt="" title="Edit Task Name" id="edit">';

        // Create the remove button with onclick attribute
        const removeButton = document.createElement('button');
        removeButton.style = "background-color: transparent; border: none;";
        removeButton.setAttribute('onclick', `deleteTask('${newTask.id}')`);
        removeButton.innerHTML = '<img src="clipboard.png" alt="" title="Remove Task" id="completed">';

        // Append the editButton and removeButton to taskImagesContainer
        taskImagesContainer.appendChild(editButton);
        taskImagesContainer.appendChild(removeButton);

        // Append taskImagesContainer to newTask
        newTask.appendChild(taskImagesContainer);

        // Append the newTask at the bottom of the existing tasks
        const tasksContainer = document.getElementById('tasks');
        tasksContainer.appendChild(newTask);

        // Save tasks to local storage after adding a new task
        saveTasksToLocalStorage();
    }
});

document.addEventListener('DOMContentLoaded', function () {
    const searchInput = document.querySelector('.search');
    const suggestionsContainer = document.createElement('div');
    suggestionsContainer.id = 'suggestions';
    searchInput.parentNode.appendChild(suggestionsContainer);

    let prevInputValue = ''; // Ruan input-in e mëparshëm
    let timeoutId; // Ruan id e timeout-it

    searchInput.addEventListener('input', function () {
        const inputValue = this.value.trim();

        // Përparim: heqim timeout-in ekzistues për të shmangur një shfaqje të vonuar të sugjerimeve
        clearTimeout(timeoutId);

        // Përdorim timeout për ta vonuar shfaqjen e sugjerimeve pas një periudhe të caktuar
        timeoutId = setTimeout(() => {
            // Nëse input-i ka ndryshuar nga i mëparshmi ose është bosh
            if (inputValue !== prevInputValue || inputValue === '') {
                // Përdor AJAX ose fetch për të dërguar kërkesën në server
                // dhe marr sugjerime në përgjigje

                // Shembull i thjeshtë:
                const mockSuggestions = ['Architecture', 'Health & Fitness', 'Languages', 'Maths', 'Politics', 'Reading', 'Robotics', 'Science', 'Web dev'];

                // Shfaq sugjerimet në div-in e krijuar duke përdorur filtrimin
                displaySuggestions(mockSuggestions, inputValue);

                // Përditëso input-in e mëparshëm
                prevInputValue = inputValue;
            }
        }, 300); // Numri i milisekondave për periudhën e vonimit
    });

    function displaySuggestions(suggestions, filterText) {
        // Përputhja me filtrin case-insensitive
        const filteredSuggestions = filterText
            ? suggestions.filter(suggestion => suggestion.toLowerCase().includes(filterText.toLowerCase()))
            : suggestions;

        // Shfaq sugjerimet në një kontenier
        suggestionsContainer.innerHTML = filteredSuggestions.map(suggestion => `<div class="suggestion">${suggestion}</div>`).join('');
    }
});

document.addEventListener('DOMContentLoaded', function () {
    const searchInput = document.querySelector('.search');
    const loupeIcon = document.querySelector('.material-icons');

    function navigateToCourse() {
        // Merr vlerën e shkruar në input
        const inputValue = searchInput.value.trim().toLowerCase();

        // Përputh input-in me kurset dhe përcakto linkun përkatës
        let courseLink = '';
        switch (inputValue) {
            case 'architecture':
                courseLink = 'https://www.coursera.org/search?query=architecture';
                break;

            case 'health & fitness':
                courseLink = 'https://www.coursera.org/search?query=health%20and%20fitness&';
                break;

            case 'languages':
                courseLink = 'https://www.coursera.org/search?query=languages&';
                break;

            case 'maths':
                courseLink = 'https://www.khanacademy.org/math';
                break;

            case 'politics':
                courseLink = 'https://www.coursera.org/search?query=politics';
                break;

            case 'reading':
                courseLink = 'https://www.coursera.org/projects/actively-learn';
                break;

            case 'robotics':
                courseLink = 'https://www.coursera.org/specializations/robotics';
                break;

            case 'science':
                courseLink = 'https://www.khanacademy.org/science';
                break;

            case 'web dev':
                courseLink = 'https://www.coursera.org/learn/html-css-javascript-for-web-developers';
                break;

            default:
                break;
        }

        if (courseLink !== '') {
            window.location.href = courseLink;
        }
    }

    loupeIcon.addEventListener('click', navigateToCourse);

    searchInput.addEventListener('keypress', function (e) {
        if (e.key === 'Enter') {
            navigateToCourse();
        }
    });
});

var originalState = document.getElementById("tasks").innerHTML;

function transformToTextboxTask1(taskTextID) {
    var textElement = document.getElementById(taskTextID);
    document.getElementById(taskTextID).textContent = "";

    // Check if the transformation has already been applied
    if (!textElement.classList.contains("editing")) {
        // Save the original content
        textElement.setAttribute("data-original-content", textElement.textContent);
        // Clear the content and create an input element
        textElement.textContent = '';
        var inputElement = document.createElement("input");
        inputElement.type = "text";
        inputElement.value = textElement.getAttribute("data-original-content");
        inputElement.classList.add("textbox1-input");
        inputElement.style.border = "none"; // Remove outline
        inputElement.style.width = "400px"; // Set a custom width
        inputElement.style.height = "50px"; // Set a custom width
        inputElement.style.outline = "none";
        inputElement.style.fontSize = "30px";
        inputElement.style.backgroundColor = "transparent";

        // Append the input element to the textElement
        textElement.appendChild(inputElement);
        inputElement.focus();

        // Attach event listener for Enter key
        inputElement.addEventListener("keydown", function (event) {
            if (event.key === "Enter") {
                // Save the changes
                textElement.textContent = inputElement.value;
                textElement.classList.remove("editing");

                // Save tasks to local storage after editing
                saveTasksToLocalStorage();
            }
        });

        // Mark the element as editing
        textElement.classList.add("editing");
    }
}

document.addEventListener("DOMContentLoaded", function () {
    // Check local storage for deleted tasks
    const deletedTasks = JSON.parse(localStorage.getItem('deletedTasks')) || [];

    // Remove deleted tasks from the DOM
    deletedTasks.forEach(function (taskId) {
        const elementToRemove = document.getElementById(taskId);
        if (elementToRemove) {
            elementToRemove.remove();
        }
    });
    
});

function deleteTask(taskId) {
    var increaseXP = document.getElementById('xp');
    console.log('Element:', increaseXP);

    if (increaseXP) {
        var vleraXP = parseInt(increaseXP.textContent);
        console.log('Current Value:', vleraXP);

        var VleraRe = vleraXP + 100;
        increaseXP.textContent = VleraRe;
        console.log('New Value:', VleraRe);
    }
    const elementToRemove = document.getElementById(taskId);

    if (elementToRemove) {
        alert("Congratulations, you have completed this task and earned 100xp.");
        elementToRemove.remove();

        // Save tasks to local storage after deleting
        saveTasksToLocalStorage();
    }
}



    </script>

</body>
</html>